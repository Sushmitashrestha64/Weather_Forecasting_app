<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Weather Dashboard - {{ city|default:"Search" }}</title>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.min.css"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
            rel="stylesheet"
        />
        <style>
            :root {
                --primary: #2563eb;
                --primary-dark: #1e40af;
                --secondary: #64748b;
                --success: #10b981;
                --warning: #f59e0b;
                --danger: #ef4444;
                --light: #f8fafc;
                --dark: #0f172a;
                --border: #e2e8f0;
                --shadow: rgba(15, 23, 42, 0.08);
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family:
                    "Inter",
                    -apple-system,
                    BlinkMacSystemFont,
                    sans-serif;
                background: var(--light);
                color: var(--dark);
                line-height: 1.6;
                min-height: 100vh;
            }

            .top-bar {
                background: white;
                border-bottom: 1px solid var(--border);
                padding: 1rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
                box-shadow: 0 1px 3px var(--shadow);
            }

            .container {
                max-width: 1400px;
                margin: 0 auto;
                padding: 0 2rem;
            }

            .nav {
                display: flex;
                align-items: center;
                justify-content: space-between;
            }

            .logo {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                font-weight: 600;
                font-size: 1.25rem;
                color: var(--dark);
                text-decoration: none;
            }

            .logo i {
                color: var(--primary);
                font-size: 1.5rem;
            }

            .back-btn {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.5rem 1rem;
                background: var(--light);
                border: 1px solid var(--border);
                border-radius: 0.5rem;
                color: var(--secondary);
                text-decoration: none;
                font-size: 0.875rem;
                font-weight: 500;
                transition: all 0.2s;
            }

            .back-btn:hover {
                background: white;
                color: var(--dark);
                border-color: var(--secondary);
            }

            .search-section {
                background: white;
                padding: 2rem;
                margin: 2rem 0;
                border-radius: 1rem;
                border: 1px solid var(--border);
                box-shadow: 0 1px 3px var(--shadow);
            }

            .search-form {
                display: flex;
                gap: 1rem;
                max-width: 800px;
            }

            .search-input {
                flex: 1;
                padding: 0.875rem 1.25rem;
                border: 2px solid var(--border);
                border-radius: 0.75rem;
                font-size: 1rem;
                font-family: inherit;
                transition: all 0.2s;
            }

            .search-input:focus {
                outline: none;
                border-color: var(--primary);
                box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
            }

            .search-btn {
                padding: 0.875rem 2rem;
                background: var(--primary);
                color: white;
                border: none;
                border-radius: 0.75rem;
                font-size: 1rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .search-btn:hover {
                background: var(--primary-dark);
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
            }

            .location-header {
                text-align: center;
                margin: 2rem 0;
            }

            .location-title {
                font-size: 2rem;
                font-weight: 700;
                color: var(--dark);
                margin-bottom: 0.5rem;
            }

            .location-subtitle {
                color: var(--secondary);
                font-size: 1rem;
            }

            .alert-badge {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.5rem 1rem;
                background: #fee;
                color: var(--danger);
                border-radius: 2rem;
                font-size: 0.875rem;
                font-weight: 600;
                margin-left: 1rem;
            }

            .grid {
                display: grid;
                gap: 1.5rem;
                margin-bottom: 2rem;
            }

            .grid-2 {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }

            .grid-3 {
                grid-template-columns: repeat(3, 1fr);
            }

            @media (max-width: 992px) {
                .grid-3 {
                    grid-template-columns: repeat(2, 1fr);
                }
            }

            @media (max-width: 640px) {
                .grid-3 {
                    grid-template-columns: 1fr;
                }
            }

            .grid-4 {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            .card {
                background: white;
                border: 1px solid var(--border);
                border-radius: 1rem;
                padding: 1.5rem;
                box-shadow: 0 1px 3px var(--shadow);
                transition: all 0.2s;
            }

            .card:hover {
                box-shadow: 0 4px 12px var(--shadow);
            }

            .weather-cards-container {
                position: relative;
                padding: 2rem;
                border-radius: 1.5rem;
                margin-bottom: 2rem;
                background-size: cover;
                background-position: center;
                background-repeat: no-repeat;
                overflow: hidden;
            }

            .weather-cards-container::before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: transparent;
                backdrop-filter: none;
                z-index: 0;
            }

            .weather-cards-container > * {
                position: relative;
                z-index: 1;
            }

            /* Distinctive weather backgrounds */
            .weather-cards-container.weather-clear {
                background-image: url("https://images.unsplash.com/photo-1601297183305-6df142704ea2?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(251, 191, 36, 0.3);
            }

            .weather-cards-container.weather-clouds {
                background-image: url("https://images.unsplash.com/photo-1534088568595-a066f410bcda?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(148, 163, 184, 0.3);
            }

            .weather-cards-container.weather-rain {
                background-image: url("https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
            }

            .weather-cards-container.weather-drizzle {
                background-image: url("https://images.unsplash.com/photo-1428908728789-d2de25dbd4e2?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(96, 165, 250, 0.3);
            }

            .weather-cards-container.weather-thunderstorm {
                background-image: url("https://images.unsplash.com/photo-1605727216801-e27ce1d0cc28?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(139, 92, 246, 0.5);
            }

            .weather-cards-container.weather-snow {
                background-image: url("https://images.unsplash.com/photo-1491002052546-bf38f186af56?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(96, 165, 250, 0.3);
            }

            .weather-cards-container.weather-mist,
            .weather-cards-container.weather-fog {
                background-image: url("https://images.unsplash.com/photo-1487621167305-5d248087c724?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(148, 163, 184, 0.4);
            }

            .weather-cards-container.weather-haze {
                background-image: url("https://images.unsplash.com/photo-1513002749550-c59d786b8e6c?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(168, 162, 158, 0.3);
            }

            .weather-cards-container.weather-default {
                background-image: url("https://images.unsplash.com/photo-1592210454359-9043f067919b?w=1400&h=600&fit=crop&q=90");
                box-shadow: 0 10px 30px rgba(96, 165, 250, 0.3);
            }

            .metric-card {
                text-align: center;
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(25px) saturate(200%);
                border: 1px solid rgba(255, 255, 255, 0.25);
                box-shadow: 0 8px 32px rgba(31, 38, 135, 0.2);
            }

            .metric-card:hover {
                background: rgba(255, 255, 255, 0.15);
                box-shadow: 0 12px 40px rgba(31, 38, 135, 0.25);
                transform: translateY(-4px);
                border: 1px solid rgba(255, 255, 255, 0.35);
            }

            .metric-icon {
                width: 3rem;
                height: 3rem;
                background: rgba(255, 255, 255, 0.3);
                backdrop-filter: blur(15px);
                border-radius: 0.75rem;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto 1rem;
                font-size: 1.5rem;
                color: var(--primary);
                border: 1px solid rgba(255, 255, 255, 0.4);
            }

            .metric-label {
                font-size: 0.875rem;
                color: rgba(15, 23, 42, 1);
                font-weight: 700;
                margin-bottom: 0.5rem;
                text-shadow: 0 2px 4px rgba(255, 255, 255, 1);
            }

            .metric-value {
                font-size: 2rem;
                font-weight: 800;
                color: var(--dark);
                margin-bottom: 0.25rem;
                text-shadow: 0 2px 4px rgba(255, 255, 255, 1);
            }

            .metric-subtitle {
                font-size: 0.875rem;
                color: rgba(15, 23, 42, 0.95);
                font-weight: 500;
                text-shadow: 0 2px 4px rgba(255, 255, 255, 1);
            }

            .section-header {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                margin: 3rem 0 1.5rem;
                font-size: 1.5rem;
                font-weight: 700;
                color: var(--dark);
            }

            .section-icon {
                color: var(--primary);
            }

            .alert-box {
                padding: 1rem 1.5rem;
                border-radius: 0.75rem;
                margin-bottom: 1rem;
                display: flex;
                align-items: flex-start;
                gap: 1rem;
                border-left: 4px solid;
            }

            .alert-critical {
                background: #fee;
                border-color: var(--danger);
                color: #7f1d1d;
            }

            .alert-warning {
                background: #fef3c7;
                border-color: var(--warning);
                color: #78350f;
            }

            .alert-icon {
                font-size: 1.25rem;
                flex-shrink: 0;
            }

            .alert-content h4 {
                font-size: 1rem;
                font-weight: 600;
                margin-bottom: 0.25rem;
            }

            .alert-content p {
                font-size: 0.875rem;
                line-height: 1.5;
            }

            .stat-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 1rem;
                padding: 1.5rem;
                background: var(--light);
                border-radius: 0.75rem;
            }

            .stat-item {
                text-align: center;
            }

            .stat-value {
                font-size: 1.75rem;
                font-weight: 700;
                color: var(--primary);
                margin-bottom: 0.25rem;
            }

            .stat-label {
                font-size: 0.875rem;
                color: var(--secondary);
            }

            .info-list {
                list-style: none;
            }

            .info-item {
                padding: 1rem 0;
                border-bottom: 1px solid var(--border);
                display: flex;
                align-items: flex-start;
                gap: 0.75rem;
            }

            .info-item:last-child {
                border-bottom: none;
            }

            .info-icon {
                color: var(--primary);
                font-size: 1.125rem;
                flex-shrink: 0;
                margin-top: 0.125rem;
            }

            .info-content h4 {
                font-size: 0.875rem;
                font-weight: 600;
                color: var(--dark);
                margin-bottom: 0.25rem;
            }

            .info-content p {
                font-size: 0.875rem;
                color: var(--secondary);
                line-height: 1.5;
            }

            .subsection {
                margin-bottom: 1.5rem;
            }

            .subsection-title {
                font-size: 1rem;
                font-weight: 600;
                color: var(--dark);
                margin-bottom: 0.75rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .badge {
                display: inline-flex;
                align-items: center;
                gap: 0.375rem;
                padding: 0.375rem 0.75rem;
                border-radius: 0.5rem;
                font-size: 0.75rem;
                font-weight: 600;
            }

            .badge-success {
                background: #d1fae5;
                color: #065f46;
            }

            .badge-info {
                background: #dbeafe;
                color: #1e40af;
            }

            .badge-warning {
                background: #fef3c7;
                color: #92400e;
            }

            .badge-danger {
                background: #fee2e2;
                color: #991b1b;
            }

            .activity-card {
                padding: 1.25rem;
                background: var(--light);
                border-radius: 0.75rem;
                border: 1px solid var(--border);
                margin-bottom: 1rem;
            }

            .activity-card h4 {
                font-size: 1.125rem;
                font-weight: 600;
                color: var(--dark);
                margin-bottom: 0.75rem;
            }

            .activity-detail {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-size: 0.875rem;
                color: var(--secondary);
                margin-bottom: 0.5rem;
            }

            .activity-detail i {
                color: var(--primary);
            }

            .news-tabs {
                display: flex;
                gap: 0.5rem;
                margin-bottom: 1.5rem;
                border-bottom: 2px solid var(--border);
            }

            .news-tab {
                padding: 0.75rem 1.5rem;
                background: transparent;
                border: none;
                border-bottom: 3px solid transparent;
                color: var(--secondary);
                font-size: 0.95rem;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.2s;
                margin-bottom: -2px;
            }

            .news-tab:hover {
                color: var(--primary);
                background: rgba(37, 99, 235, 0.05);
            }

            .news-tab.active {
                color: var(--primary);
                border-bottom-color: var(--primary);
            }

            .news-tab i {
                margin-right: 0.5rem;
            }

            .news-content {
                display: none;
            }

            .news-content.active {
                display: block;
            }

            .news-card {
                display: block;
                padding: 1.5rem;
                background: white;
                border: 1px solid var(--border);
                border-radius: 0.75rem;
                text-decoration: none;
                color: inherit;
                transition: all 0.2s;
                margin-bottom: 1rem;
            }

            .news-card:hover {
                border-color: var(--primary);
                box-shadow: 0 4px 12px var(--shadow);
                transform: translateY(-2px);
            }

            .news-header {
                display: flex;
                align-items: flex-start;
                gap: 1rem;
                margin-bottom: 0.75rem;
            }

            .news-number {
                flex-shrink: 0;
                width: 2rem;
                height: 2rem;
                background: var(--primary);
                color: white;
                border-radius: 0.5rem;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: 700;
                font-size: 0.875rem;
            }

            .news-title {
                flex: 1;
                font-size: 1rem;
                font-weight: 600;
                color: var(--dark);
                line-height: 1.5;
            }

            .news-meta {
                display: flex;
                align-items: center;
                gap: 1rem;
                font-size: 0.75rem;
                color: var(--secondary);
                flex-wrap: wrap;
            }

            .news-source {
                display: flex;
                align-items: center;
                gap: 0.375rem;
                font-weight: 500;
            }

            .no-data {
                text-align: center;
                padding: 4rem 2rem;
                color: var(--secondary);
            }

            .no-data i {
                font-size: 3rem;
                color: var(--border);
                margin-bottom: 1rem;
                display: block;
            }

            .progress-bar {
                height: 0.5rem;
                background: rgba(255, 255, 255, 0.3);
                border-radius: 0.25rem;
                overflow: hidden;
                margin-top: 0.5rem;
                border: 1px solid rgba(255, 255, 255, 0.2);
            }

            .progress-fill {
                height: 100%;
                background: linear-gradient(90deg, var(--primary), #60a5fa);
                border-radius: 0.25rem;
                transition: width 1s ease;
                box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
            }

            .hourly-forecast-card {
                padding: 0 !important;
                overflow: hidden;
                transition: all 0.3s ease;
                border: 1px solid var(--border);
                cursor: pointer;
            }

            .hourly-forecast-card:hover {
                transform: translateY(-8px);
                box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
                border-color: var(--primary);
            }

            .hourly-forecast-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                padding: 12px;
                text-align: center;
                color: white;
                transition: all 0.3s ease;
            }

            .hourly-forecast-card:hover .hourly-forecast-header {
                background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            }

            .hourly-forecast-body {
                padding: 20px 16px 16px;
                text-align: center;
                background: linear-gradient(to bottom, #f8fafc 0%, white 100%);
            }

            @keyframes pulse {
                0%, 100% {
                    transform: scale(1);
                    opacity: 1;
                }
                50% {
                    transform: scale(1.1);
                    opacity: 0.8;
                }
            }

            @media (max-width: 768px) {
                .container {
                    padding: 0 1rem;
                }

                .search-form {
                    flex-direction: column;
                }

                .location-title {
                    font-size: 1.5rem;
                }

                .section-header {
                    font-size: 1.25rem;
                }

                .metric-value {
                    font-size: 1.5rem;
                }

                .hourly-forecast-card {
                    min-width: 140px;
                }

                .hourly-forecast-body {
                    padding: 16px 12px 12px;
                }
            }
        </style>
    </head>
    <body>
        <div class="top-bar">
            <div class="container">
                <nav class="nav">
                    <a href="{% url 'weather_dashboard' %}" class="logo">
                        <i class="bi bi-cloud-sun-fill"></i>
                        <span>Weather Analytics</span>
                    </a>
                    <a href="{% url 'weather_dashboard' %}" class="back-btn">
                        <i class="bi bi-arrow-left"></i>
                        Back to Home
                    </a>
                </nav>
            </div>
        </div>

        <div class="container">
            <div class="search-section">
                <form method="POST" class="search-form">
                    {% csrf_token %}
                    <input
                        type="text"
                        name="city"
                        class="search-input"
                        placeholder="Search for a city (e.g., London, Tokyo, New York)..."
                        value="{{ city }}"
                        required
                    />
                    <button type="submit" class="search-btn">
                        <i class="bi bi-search"></i>
                        Analyze Weather
                    </button>
                </form>
            </div>

            {% if messages %}
            <div style="margin: 20px 0">
                {% for message in messages %}
                <div
                    style="background: {% if message.tags == 'error' %}#fee2e2{% elif message.tags == 'success' %}#d1fae5{% else %}#dbeafe{% endif %};
                            color: {% if message.tags == 'error' %}#991b1b{% elif message.tags == 'success' %}#065f46{% else %}#1e40af{% endif %};
                            padding: 16px 20px;
                            border-radius: 12px;
                            border-left: 4px solid {% if message.tags == 'error' %}#dc2626{% elif message.tags == 'success' %}#059669{% else %}#3b82f6{% endif %};
                            display: flex;
                            align-items: center;
                            gap: 12px;
                            backdrop-filter: blur(10px);
                            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);"
                >
                    <i
                        class="bi {% if message.tags == 'error' %}bi-exclamation-circle-fill{% elif message.tags == 'success' %}bi-check-circle-fill{% else %}bi-info-circle-fill{% endif %}"
                        style="font-size: 1.25rem"
                    ></i>
                    <span style="font-weight: 500">{{ message }}</span>
                </div>
                {% endfor %}
            </div>
            {% endif %} {% if city_suggestions %}
            <div style="margin: 20px 0">
                <div
                    style="
                        background: rgba(255, 255, 255, 0.1);
                        backdrop-filter: blur(10px);
                        border-radius: 12px;
                        padding: 20px;
                        border: 1px solid rgba(255, 255, 255, 0.2);
                    "
                >
                    <p
                        style="
                            margin: 0 0 12px 0;
                            font-weight: 600;
                            color: #1e293b;
                        "
                    >
                        <i
                            class="bi bi-lightbulb-fill"
                            style="color: #f59e0b; margin-right: 8px"
                        ></i>
                        Did you mean one of these cities?
                    </p>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap">
                        {% for suggestion in city_suggestions %}
                        <form method="POST" style="display: inline">
                            {% csrf_token %}
                            <input
                                type="hidden"
                                name="city"
                                value="{{ suggestion }}"
                            />
                            <button
                                type="submit"
                                style="
                                    background: linear-gradient(
                                        135deg,
                                        #667eea 0%,
                                        #764ba2 100%
                                    );
                                    color: white;
                                    border: none;
                                    padding: 10px 20px;
                                    border-radius: 8px;
                                    font-weight: 500;
                                    cursor: pointer;
                                    transition: all 0.3s;
                                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                                "
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)';"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(0, 0, 0, 0.1)';"
                            >
                                <i class="bi bi-geo-alt-fill"></i> {{ suggestion
                                }}
                            </button>
                        </form>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endif %} {% if city %}
            <div class="location-header">
                <h1 class="location-title">
                    <i class="bi bi-geo-alt-fill"></i> {{ city }}, {{ country }}
                    {% if extreme_warnings %}
                    <span class="alert-badge">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                        {{ extreme_warnings|length }} Alert{{ extreme_warnings|length|pluralize }}
                    </span>
                    {% endif %}
                </h1>
                <p class="location-subtitle">
                    {% if 'clear' in current_weather.description|lower %}
                    <i class="bi bi-sun-fill" style="color: #fbbf24"></i>
                    {% elif 'cloud' in current_weather.description|lower and 'few' in current_weather.description|lower %}
                    <i class="bi bi-cloud-sun-fill" style="color: #60a5fa"></i>
                    {% elif 'cloud' in current_weather.description|lower %}
                    <i class="bi bi-cloud-fill" style="color: #94a3b8"></i>
                    {% elif 'rain' in current_weather.description|lower or 'drizzle' in current_weather.description|lower %}
                    <i class="bi bi-cloud-rain-fill" style="color: #3b82f6"></i>
                    {% elif 'thunder' in current_weather.description|lower or 'storm' in current_weather.description|lower %}
                    <i
                        class="bi bi-cloud-lightning-fill"
                        style="color: #8b5cf6"
                    ></i>
                    {% elif 'snow' in current_weather.description|lower %}
                    <i class="bi bi-cloud-snow-fill" style="color: #60a5fa"></i>
                    {% elif 'mist' in current_weather.description|lower or 'fog' in current_weather.description|lower %}
                    <i class="bi bi-cloud-fog-fill" style="color: #94a3b8"></i>
                    {% elif 'haze' in current_weather.description|lower %}
                    <i class="bi bi-cloud-haze-fill" style="color: #a8a29e"></i>
                    {% else %}
                    <i class="bi bi-cloud-sun-fill" style="color: #60a5fa"></i>
                    {% endif %} {{ current_weather.description|title }}
                    <span style="opacity: 0.7">•</span>
                    <i class="bi bi-clock" style="font-size: 0.9em"></i> Last
                    updated: now
                </p>
            </div>

            <div
                class="weather-cards-container weather-{% if 'clear' in current_weather.description|lower %}clear{% elif 'rain' in current_weather.description|lower %}rain{% elif 'drizzle' in current_weather.description|lower %}drizzle{% elif 'thunder' in current_weather.description|lower or 'storm' in current_weather.description|lower %}thunderstorm{% elif 'snow' in current_weather.description|lower %}snow{% elif 'mist' in current_weather.description|lower or 'fog' in current_weather.description|lower %}mist{% elif 'haze' in current_weather.description|lower %}haze{% elif 'cloud' in current_weather.description|lower %}clouds{% else %}default{% endif %}"
            >
                <div class="grid grid-3">
                    <div class="card metric-card">
                        <div class="metric-icon">
                            <i class="bi bi-thermometer-half"></i>
                        </div>
                        <div class="metric-label">Temperature</div>
                        <div class="metric-value">
                            {{ current_weather.current_temp|floatformat:1 }}°C
                        </div>
                        <div class="metric-subtitle">
                            Feels like {{ current_weather.feels_like|floatformat:1 }}°C
                        </div>
                        <div class="progress-bar">
                            <div
                                class="progress-fill"
                                style="width: {% widthratio current_weather.current_temp 50 100 %}%"
                            ></div>
                        </div>
                    </div>

                    <div class="card metric-card">
                        <div class="metric-icon">
                            <i class="bi bi-droplet-half"></i>
                        </div>
                        <div class="metric-label">Humidity</div>
                        <div class="metric-value">
                            {{ current_weather.humidity }}%
                        </div>
                        <div class="metric-subtitle">
                            Dew Point: {{ dew_point|floatformat:1 }}°C
                        </div>
                        <div class="progress-bar">
                            <div
                                class="progress-fill"
                                style="width: {{ current_weather.humidity }}%"
                            ></div>
                        </div>
                    </div>

                    <div class="card metric-card">
                        <div class="metric-icon">
                            <i class="bi bi-cloud-rain"></i>
                        </div>
                        <div class="metric-label">Rain Probability</div>
                        <div class="metric-value">
                            {{ precip_probability|floatformat:0 }}%
                        </div>
                        <div class="metric-subtitle">Advanced calculation</div>
                        <div class="progress-bar">
                            <div
                                class="progress-fill"
                                style="width: {{ precip_probability }}%"
                            ></div>
                        </div>
                    </div>

                    <div class="card metric-card">
                        <div class="metric-icon">
                            <i class="bi bi-fire"></i>
                        </div>
                        <div class="metric-label">Heat Index</div>
                        <div class="metric-value">
                            {{ heat_index|floatformat:1 }}°C
                        </div>
                        <div class="metric-subtitle">Apparent temperature</div>
                    </div>

                    <div class="card metric-card">
                        <div class="metric-icon">
                            <i class="bi bi-snow2"></i>
                        </div>
                        <div class="metric-label">Wind Chill</div>
                        <div class="metric-value">
                            {{ wind_chill|floatformat:1 }}°C
                        </div>
                        <div class="metric-subtitle">With wind effect</div>
                    </div>

                    <div class="card metric-card">
                        <div class="metric-icon">
                            <i class="bi bi-emoji-smile"></i>
                        </div>
                        <div class="metric-label">Comfort Index</div>
                        <div class="metric-value">
                            {{ comfort_index.score }}/100
                        </div>
                        <div class="metric-subtitle">
                            {{ comfort_index.level }}
                        </div>
                        <div class="progress-bar">
                            <div
                                class="progress-fill"
                                style="width: {{ comfort_index.score }}%"
                            ></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 5-Hour Weather Forecast Section -->
            <h2 class="section-header">
                <i class="bi bi-clock-history section-icon"></i>
                Hourly Weather Forecast
            </h2>
            <div class="card">
                {% if hourly_predictions %}
                <div class="subsection">
                    <h3 class="subsection-title">
                        <i class="bi bi-clock-history"></i> Hourly Forecast
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px;">
                        {% for prediction in hourly_predictions %}
                        <div class="card hourly-forecast-card">
                            <!-- Header with time -->
                            <div class="hourly-forecast-header">
                                <div style="font-size: 0.75rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px;">
                                    +{{ prediction.hour }} Hour{{ prediction.hour|pluralize }}
                                </div>
                                <div style="font-size: 1rem; font-weight: 600;">
                                    {{ prediction.time }}
                                </div>
                            </div>
                            
                            <!-- Weather Icon -->
                            <div class="hourly-forecast-body">
                                <div style="margin-bottom: 12px; position: relative; display: inline-block;">
                                    {% if prediction.humidity > 85 and prediction.temperature < 15 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(59, 130, 246, 0.2), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-cloud-rain-heavy-fill" style="font-size: 3.5rem; color: #3b82f6; filter: drop-shadow(0 4px 12px rgba(59, 130, 246, 0.5));"></i>
                                        </div>
                                    {% elif prediction.humidity > 75 and prediction.temperature < 20 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(96, 165, 250, 0.2), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-cloud-drizzle-fill" style="font-size: 3.5rem; color: #60a5fa; filter: drop-shadow(0 4px 12px rgba(96, 165, 250, 0.5));"></i>
                                        </div>
                                    {% elif prediction.humidity > 80 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(148, 163, 184, 0.2), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-cloud-fog2-fill" style="font-size: 3.5rem; color: #94a3b8; filter: drop-shadow(0 4px 12px rgba(148, 163, 184, 0.5));"></i>
                                        </div>
                                    {% elif prediction.temperature > 30 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(245, 158, 11, 0.25), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-sun-fill" style="font-size: 3.5rem; color: #f59e0b; filter: drop-shadow(0 4px 12px rgba(245, 158, 11, 0.6)); animation: pulse 2s ease-in-out infinite;"></i>
                                        </div>
                                    {% elif prediction.temperature > 25 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(251, 191, 36, 0.25), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-brightness-high-fill" style="font-size: 3.5rem; color: #fbbf24; filter: drop-shadow(0 4px 12px rgba(251, 191, 36, 0.5));"></i>
                                        </div>
                                    {% elif prediction.temperature > 20 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(96, 165, 250, 0.2), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-cloud-sun-fill" style="font-size: 3.5rem; color: #60a5fa; filter: drop-shadow(0 4px 12px rgba(96, 165, 250, 0.5));"></i>
                                        </div>
                                    {% elif prediction.temperature > 15 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(148, 163, 184, 0.2), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-clouds-fill" style="font-size: 3.5rem; color: #94a3b8; filter: drop-shadow(0 4px 12px rgba(148, 163, 184, 0.5));"></i>
                                        </div>
                                    {% elif prediction.temperature > 10 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(100, 116, 139, 0.2), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-cloud-fill" style="font-size: 3.5rem; color: #64748b; filter: drop-shadow(0 4px 12px rgba(100, 116, 139, 0.5));"></i>
                                        </div>
                                    {% elif prediction.temperature > 5 %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(124, 58, 237, 0.2), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-cloud-haze-fill" style="font-size: 3.5rem; color: #7c3aed; filter: drop-shadow(0 4px 12px rgba(124, 58, 237, 0.5));"></i>
                                        </div>
                                    {% else %}
                                        <div style="width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(circle, rgba(96, 165, 250, 0.2), transparent); display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                            <i class="bi bi-snow" style="font-size: 3.5rem; color: #60a5fa; filter: drop-shadow(0 4px 12px rgba(96, 165, 250, 0.5));"></i>
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Temperature -->
                                <div style="margin-bottom: 12px;">
                                    <div style="font-size: 2rem; font-weight: 700; color: var(--primary); line-height: 1;">
                                        {{ prediction.temperature|floatformat:1 }}°C
                                    </div>
                                    <div style="font-size: 0.75rem; color: var(--secondary); margin-top: 4px;">
                                        {% if prediction.temperature > current_weather.current_temp %}
                                            <i class="bi bi-arrow-up" style="color: #ef4444;"></i> Warmer
                                        {% elif prediction.temperature < current_weather.current_temp %}
                                            <i class="bi bi-arrow-down" style="color: #3b82f6;"></i> Cooler
                                        {% else %}
                                            <i class="bi bi-dash"></i> Same
                                        {% endif %}
                                    </div>
                                </div>
                                
                                <!-- Humidity -->
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; padding: 8px 12px; background: #f1f5f9; border-radius: 8px; margin-bottom: 8px;">
                                    <i class="bi bi-droplet-fill" style="color: #3b82f6; font-size: 0.9rem;"></i>
                                    <span style="font-size: 0.875rem; font-weight: 600; color: var(--dark);">
                                        {{ prediction.humidity|floatformat:0 }}%
                                    </span>
                                    <span style="font-size: 0.75rem; color: var(--secondary);">
                                        Humidity
                                    </span>
                                </div>
                                
                                <!-- Condition Badge -->
                                <div style="margin-top: 8px;">
                                    {% if prediction.humidity > 80 %}
                                        <span style="display: inline-block; padding: 4px 10px; background: #dbeafe; color: #1e40af; border-radius: 12px; font-size: 0.75rem; font-weight: 500;">
                                            <i class="bi bi-droplet"></i> Humid
                                        </span>
                                    {% elif prediction.humidity < 30 %}
                                        <span style="display: inline-block; padding: 4px 10px; background: #fef3c7; color: #92400e; border-radius: 12px; font-size: 0.75rem; font-weight: 500;">
                                            <i class="bi bi-sun"></i> Dry
                                        </span>
                                    {% else %}
                                        <span style="display: inline-block; padding: 4px 10px; background: #d1fae5; color: #065f46; border-radius: 12px; font-size: 0.75rem; font-weight: 500;">
                                            <i class="bi bi-check-circle"></i> Comfortable
                                        </span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% else %}
                <div class="subsection">
                    <p style="text-align: center; color: #666; padding: 20px">
                        <i class="bi bi-info-circle"></i> No hourly predictions
                        available at this time.
                    </p>
                </div>
                {% endif %}

                <div
                    style="
                        margin-top: 20px;
                        padding: 15px;
                        background: #f0f9ff;
                        border-radius: 8px;
                        border-left: 4px solid var(--primary);
                    "
                >
                    <div style="display: flex; align-items: center; gap: 10px">
                        <i
                            class="bi bi-info-circle"
                            style="color: var(--primary); font-size: 1.2em"
                        ></i>
                        <span style="color: #1e40af; font-size: 0.95em">
                            {% if hourly_predictions.0.method == 'heuristic' %}
                            These predictions are generated using intelligent
                            weather analysis algorithms.
                            {% else %}
                            These predictions are generated using machine learning
                            models trained on historical weather data.
                            {% endif %}
                            Actual conditions may vary.
                        </span>
                    </div>
                </div>
            </div>

            {% if extreme_warnings %}
            <h2 class="section-header">
                <i class="bi bi-exclamation-triangle-fill section-icon"></i>
                Weather Alerts
            </h2>
            <div class="card">
                {% for warning in extreme_warnings %}
                <div class="alert-box alert-{{ warning.severity }}">
                    <i class="bi bi-exclamation-circle-fill alert-icon"></i>
                    <div class="alert-content">
                        <h4>{{ warning.type|upper }}</h4>
                        <p>{{ warning.message }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <h2 class="section-header">
                <i class="bi bi-graph-up section-icon"></i>
                Weather Statistics
            </h2>
            <div class="card">
                <div class="stat-grid">
                    <div class="stat-item">
                        <div class="stat-value">
                            {{ current_weather.pressure }}
                        </div>
                        <div class="stat-label">Pressure (hPa)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">
                            {{ current_weather.wind_speed|floatformat:1 }}
                        </div>
                        <div class="stat-label">Wind Speed (m/s)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">
                            {{ current_weather.clouds }}%
                        </div>
                        <div class="stat-label">Cloud Cover</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ search_count }}</div>
                        <div class="stat-label">Total Searches</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ prediction_count }}</div>
                        <div class="stat-label">Predictions Logged</div>
                    </div>
                </div>
            </div>

            {% if travel_insights.overall_conditions %}
            <h2 class="section-header">
                <i class="bi bi-airplane section-icon"></i>
                Travel Conditions
            </h2>
            <div class="card">
                <ul class="info-list">
                    {% if travel_insights.overall_conditions %}
                    <li class="info-item">
                        <i class="bi bi-info-circle info-icon"></i>
                        <div class="info-content">
                            <h4>Overall Conditions</h4>
                            <p>{{ travel_insights.overall_conditions }}</p>
                        </div>
                    </li>
                    {% endif %} {% if travel_insights.driving_conditions %}
                    <li class="info-item">
                        <i class="bi bi-car-front info-icon"></i>
                        <div class="info-content">
                            <h4>Driving Conditions</h4>
                            <p>{{ travel_insights.driving_conditions }}</p>
                        </div>
                    </li>
                    {% endif %} {% if travel_insights.public_transport %}
                    <li class="info-item">
                        <i class="bi bi-bus-front info-icon"></i>
                        <div class="info-content">
                            <h4>Public Transport</h4>
                            <p>{{ travel_insights.public_transport }}</p>
                        </div>
                    </li>
                    {% endif %}
                </ul>
            </div>
            {% endif %}

            <h2 class="section-header">
                <i class="bi bi-newspaper section-icon"></i>
                Weather News
            </h2>

            <div class="news-tabs">
                <button
                    class="news-tab active"
                    onclick="switchNewsTab('global')"
                >
                    <i class="bi bi-globe"></i>
                    Global Weather News
                </button>
                <button class="news-tab" onclick="switchNewsTab('local')">
                    <i class="bi bi-geo-alt"></i>
                    Local News - {{ city }}
                </button>
            </div>

            <div id="global-news" class="news-content active">
                {% if global_news %} {% for news in global_news %}
                <a
                    href="{{ news.link }}"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="news-card"
                >
                    <div class="news-header">
                        <div class="news-number">{{ forloop.counter }}</div>
                        <div class="news-title">{{ news.title }}</div>
                    </div>
                    <div class="news-meta">
                        <span class="news-source">
                            <i class="bi bi-building"></i>
                            {{ news.source }}
                        </span>
                        <span>
                            <i class="bi bi-clock"></i>
                            {{ news.published }}
                        </span>
                        <span style="margin-left: auto">
                            <i class="bi bi-arrow-right"></i>
                        </span>
                    </div>
                </a>
                {% endfor %} {% else %}
                <p
                    style="
                        color: var(--secondary);
                        text-align: center;
                        padding: 2rem;
                    "
                >
                    No global weather news available at the moment.
                </p>
                {% endif %}
            </div>

            <div id="local-news" class="news-content">
                {% if location_news %} {% for news in location_news %}
                <a
                    href="{{ news.link }}"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="news-card"
                >
                    <div class="news-header">
                        <div class="news-number">{{ forloop.counter }}</div>
                        <div class="news-title">{{ news.title }}</div>
                    </div>
                    <div class="news-meta">
                        <span class="news-source">
                            <i class="bi bi-building"></i>
                            {{ news.source }}
                        </span>
                        <span>
                            <i class="bi bi-clock"></i>
                            {{ news.published }}
                        </span>
                        <span style="margin-left: auto">
                            <i class="bi bi-arrow-right"></i>
                        </span>
                    </div>
                </a>
                {% endfor %} {% else %}
                <p
                    style="
                        color: var(--secondary);
                        text-align: center;
                        padding: 2rem;
                    "
                >
                    No local weather news available for {{ city }} at the
                    moment.
                </p>
                {% endif %}
            </div>

            {% else %}
            <div class="no-data">
                <i class="bi bi-search"></i>
                <h2>Start Your Weather Analysis</h2>
                <p>
                    Enter a city name above to view comprehensive weather
                    analytics and insights
                </p>
            </div>
            {% endif %}
        </div>

        <div style="height: 4rem"></div>

        <script>
            function switchNewsTab(tab) {
                // Remove active class from all tabs and contents
                document
                    .querySelectorAll(".news-tab")
                    .forEach((t) => t.classList.remove("active"));
                document
                    .querySelectorAll(".news-content")
                    .forEach((c) => c.classList.remove("active"));

                // Add active class to selected tab and content
                if (tab === "global") {
                    document
                        .querySelector(".news-tab:first-child")
                        .classList.add("active");
                    document
                        .getElementById("global-news")
                        .classList.add("active");
                } else if (tab === "local") {
                    document
                        .querySelector(".news-tab:last-child")
                        .classList.add("active");
                    document
                        .getElementById("local-news")
                        .classList.add("active");
                }
            }
        </script>
    </body>
</html>
